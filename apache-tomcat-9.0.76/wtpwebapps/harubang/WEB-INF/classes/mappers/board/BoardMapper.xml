<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="com.project.harubang.board.BoardMapper">
 
 	<insert id="insertBoard">
        insert into hb_board (seq, id, bcategory, title, bcontent) 
        SELECT IFNULL(MAX(seq), 0)+1, #{id}, #{bcategory}, #{title}, #{bcontent} FROM hb_board;
    </insert>
    
    <update id="updateBoard">
    	update hb_board set title = #{title}, bcontent = #{bcontent} where seq = #{seq};
    </update>
    
    <delete id="deleteBoard">
    	delete from hb_board where seq = #{seq};
    </delete>
    
    <select id="getBoard" resultType="com.project.harubang.board.BoardVO">
    	select * from hb_board where seq = #{seq};
    </select>
    
    <update id="increaseViewCount">
    	update hb_board set cnt = cnt + 1 where seq = #{seq};
    </update>
    
	<select id="getBoardList" parameterType="com.project.harubang.board.BoardVO" resultType="com.project.harubang.board.BoardVO">
	    SELECT *
	    FROM hb_board
	    WHERE
	    <choose>
	        <when test="searchCondition == 'TITLE' and searchKeyword != null">
	            title LIKE CONCAT('%', #{searchKeyword}, '%')
	        </when>
	        <when test="searchCondition == 'CONTENT' and searchKeyword != null">
	            bcontent LIKE CONCAT('%', #{searchKeyword}, '%')
	        </when>
	        <otherwise>
	            1 = 1
	        </otherwise>
	    </choose>
	    ORDER BY seq DESC
	</select>
   
</mapper>